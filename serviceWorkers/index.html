<!DOCTYPE html>
<html lang="en">
<head>
    <title>First Service Worker</title>
</head>
<body>
    <h1>Service Worker Test</h1>
    <output id="output"></output>

    <script>
        navigator.serviceWorker.register("serviceworker.js", 
            { scope: "serviceWorkers" })
            .then( registration => {
                const scope = registration.scope;
                document.querySelector("#output").innerHTML = "Service Worker Registered properly";
                console.log(`Service Worker Registered Properly at ${scope}`);
                return navigator.serviceWorker.ready;
            })
            .catch(error => {
                document.querySelector("#output").innerHTML = "Service Worker Failed to Register";
                console.log("Service Worker Failed to Register", error);
            })
            .then( () => {
                document.querySelector("#output").innerHTML = "Service Worker Ready";
                console.log("Service Worker Ready");
            });

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistration()
                .then( registration => {
                    registration.addEventListener("updatefound", event => {
                        const swInstalling = registration.installing;
                        if (swInstalling.state=='installed') {
                            document.querySelector("#output").innerHTML = "Service Worker Installed";
                            console.log("Service Worker Installed");
                        }
                    });
                })
                .catch(error => {
                    console.log("Service Worker Failed to Get Registration", error);
                });
        }

        </script>

</body>
    
</html>