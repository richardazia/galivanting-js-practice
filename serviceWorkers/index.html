<!DOCTYPE html>
<html lang="en">

<h1>Service Worker Test</h1>
<output></output>

<button onclick="update()">Update Check</button>

<script>
function update() {
    navigator.serviceWorker.getRegistration()
    .then(registration => {
        registration.update();
    });
}

if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register("serviceworker.js", 
            { scope: "serviceWorkers" })
            .then( registration => {
                const scope = registration.scope;
                document.querySelector("output").innerHTML = 
                `Service Worker Registered Properly at ${scope}`;
            })
            .catch(error => {
                document.querySelector("output").innerHTML = 
                "Service Worker Failed to Register";
            });
} else {
    document.querySelector("#output").innerHTML =
    "Service Worker Not Available";
}

if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistration()
        .then( registration => {
            registration.addEventListener("updatefound", event => {
                const swInstalling = registration.installing;
                swInstalling.addEventListener("statechange", () => {
                    if (swInstalling.state=='installed') {
                        document.querySelector("output").innerHTML = 
                "A new Service Worker is installed and waiting";                        
                    } else {
                        document.querySelector("output").innerHTML = 
                "A new Service Worker is now controlling the page";
                    }
                });
            });
        })
        .catch( error => {

        });
}

        </script>

</body>
    
</html>